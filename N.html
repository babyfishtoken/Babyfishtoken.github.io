<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ùˆ ØªØ´Ø®ÛŒØµ ØªÙˆÚ©Ù†</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

<style>
body{
  background:#0f172a;
  color:white;
  text-align:center;
  font-family:sans-serif;
  padding:30px;
}
input,button{
  padding:12px;
  margin:10px;
  border-radius:10px;
  border:none;
  width:90%;
  max-width:400px;
}
.box{
  background:#1e293b;
  padding:15px;
  border-radius:10px;
  margin-top:20px;
}
</style>
</head>

<body>

<h2>ğŸ”— Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ ØªÙˆÚ©Ù†</h2>

<div id="wallet-btn"></div>

<br>

<input id="token" placeholder="Ø¢Ø¯Ø±Ø³ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ØªÙˆÚ©Ù†">

<br>

<button onclick="loadToken()">Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª</button>

<div id="result"></div>


<script type="module">
import { createWeb3Modal, defaultWagmiConfig } 
from "https://esm.sh/@web3modal/wagmi";

import { polygon, polygonAmoy } 
from "https://esm.sh/wagmi/chains";

// âš ï¸ projectId Ø®ÙˆØ¯Øª
const projectId = "96f13374b0fe2f629a925617de0a2ba3";

const metadata = {
  name: "My Polygon Website",
  description: "Web3 Polygon App",
  url: "https://babyfishtoken.github.io",
  icons: []
};

const chains = [polygon, polygonAmoy];

const wagmiConfig = defaultWagmiConfig({
  chains,
  projectId,
  metadata
});

createWeb3Modal({
  wagmiConfig,
  projectId,
  chains
});

// Ø³Ø§Ø®Øª Ø¯Ú©Ù…Ù‡
const btn = document.createElement("w3m-button");
document.getElementById("wallet-btn").appendChild(btn);

</script>


<script>
let provider;

// Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„
window.addEventListener("load", () => {
  if(window.ethereum){
    provider = new ethers.providers.Web3Provider(window.ethereum);
  }
});

const ABI = [
  "function name() view returns (string)",
  "function symbol() view returns (string)",
  "function decimals() view returns (uint8)"
];

async function loadToken(){

  const addr = document.getElementById("token").value.trim();
  const result = document.getElementById("result");

  if(!provider){
    alert("Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†");
    return;
  }

  if(!addr){
    alert("Ø¢Ø¯Ø±Ø³ ØªÙˆÚ©Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†");
    return;
  }

  result.innerHTML="â³ Ø¯Ø± Ø­Ø§Ù„ Ø®ÙˆØ§Ù†Ø¯Ù†...";

  try{

    const token = new ethers.Contract(addr, ABI, provider);

    let name="Unknown";
    let symbol="???";
    let decimals=18;

    try{ name = await token.name(); }catch{}
    try{ symbol = await token.symbol(); }catch{}
    try{ decimals = await token.decimals(); }catch{}

    result.innerHTML = `
      <div class="box">
        <h3>${name} (${symbol})</h3>
        Ø§Ø¹Ø´Ø§Ø±: ${decimals}<br>
        âœ”ï¸ ØªÙˆÚ©Ù† Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯
      </div>
    `;

  }catch(e){
    console.log(e);
    result.innerHTML="âŒ Ø§ÛŒÙ† Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ØªÙˆÚ©Ù† Ù†ÛŒØ³Øª";
  }
}
</script>

</body>
</html>
