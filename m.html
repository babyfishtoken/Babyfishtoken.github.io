<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ø±Ø³ÛŒ ØªÙˆÚ©Ù† Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 500px;
            width: 100%;
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            color: #94a3b8;
            font-size: 14px;
            margin-bottom: 30px;
        }
        
        .wallet-section {
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        #wallet-btn {
            margin: 15px 0;
            min-height: 50px;
        }
        
        .wallet-address {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 30px;
            font-family: monospace;
            font-size: 14px;
            color: #94a3b8;
            word-break: break-all;
        }
        
        .search-section {
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #cbd5e1;
            font-size: 14px;
        }
        
        input, select {
            width: 100%;
            padding: 14px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: white;
            font-size: 15px;
            direction: ltr;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255,255,255,0.1);
        }
        
        input::placeholder {
            color: #475569;
        }
        
        button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 16px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .balance-info {
            text-align: center;
        }
        
        .token-symbol {
            font-size: 18px;
            color: #94a3b8;
            margin-bottom: 10px;
        }
        
        .balance-amount {
            font-size: 42px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }
        
        .not-found {
            color: #ef4444;
            text-align: center;
            padding: 20px;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            color: #ef4444;
            text-align: center;
            padding: 15px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin-top: 20px;
        }
        
        .note {
            color: #94a3b8;
            font-size: 12px;
            margin-top: 20px;
            text-align: center;
        }
        
        .example-btn {
            background: rgba(255,255,255,0.05);
            border: 1px dashed #667eea;
            color: #94a3b8;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 10px;
            display: inline-block;
        }
        
        .example-btn:hover {
            background: rgba(102, 126, 234, 0.2);
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Ø¨Ø±Ø±Ø³ÛŒ ØªÙˆÚ©Ù† Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„</h1>
        <p class="subtitle">ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù†ØªØ±Ú©Øª Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØµÙ„ Ø´Ù…Ø§</p>
        
        <!-- Ø¨Ø®Ø´ Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ -->
        <div class="wallet-section">
            <div id="wallet-btn"></div>
            <div id="walletAddress" class="wallet-address" style="display: none;"></div>
        </div>
        
        <!-- Ø¨Ø®Ø´ Ø¬Ø³ØªØ¬Ùˆ -->
        <div class="search-section">
            <div class="input-group">
                <label>ğŸ“ Ø´Ø¨Ú©Ù‡</label>
                <select id="networkSelect">
                    <option value="eth" selected>Ø§ØªØ±ÛŒÙˆÙ… (Ethereum)</option>
                    <option value="polygon">Ù¾Ø§Ù„ÛŒÚ¯Ø§Ù† (Polygon)</option>
                    <option value="bsc">Ø¨Ø§ÛŒÙ†Ù†Ø³ Ø§Ø³Ù…Ø§Ø±Øª Ú†ÛŒÙ† (BSC)</option>
                    <option value="arbitrum">Ø¢Ø±Ø¨ÛŒØªØ±ÙˆÙ… (Arbitrum)</option>
                    <option value="optimism">Ø§Ù¾ØªÛŒÙ…ÛŒØ³Ù… (Optimism)</option>
                    <option value="base">Ø¨ÛŒØ³ (Base)</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>ğŸ“ Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù†ØªØ±Ú©Øª ØªÙˆÚ©Ù†</label>
                <input type="text" id="tokenAddress" placeholder="0x..." value="0x6982508145454ce325ddbe47a25d4ec3d2311933">
                <div style="text-align: left; margin-top: 5px;">
                    <span class="example-btn" onclick="document.getElementById('tokenAddress').value='0x6982508145454ce325ddbe47a25d4ec3d2311933'">ğŸ”µ Ù†Ù…ÙˆÙ†Ù‡: PEPE</span>
                </div>
            </div>
            
            <button id="checkBtn" disabled>Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ</button>
        </div>
        
        <!-- Ø¨Ø®Ø´ Ù†ØªÛŒØ¬Ù‡ -->
        <div id="result" style="display: none;"></div>
        
        <!-- Ø¨Ø®Ø´ Ø®Ø·Ø§ -->
        <div id="error" class="error" style="display: none;"></div>
        
        <div class="note">
            âš¡ Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯ØŒ Ø³Ù¾Ø³ Ø¢Ø¯Ø±Ø³ ØªÙˆÚ©Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯
        </div>
    </div>

    <script type="import">
        import { createWeb3Modal, defaultWagmiConfig } from "https://esm.sh/@web3modal/wagmi";
        import { mainnet, polygon, bsc, arbitrum, optimism, base } from "https://esm.sh/wagmi/chains";
        import { getAccount, watchAccount } from "https://esm.sh/wagmi/actions";
        import { readContract } from "https://esm.sh/wagmi/actions";
        import { formatUnits } from "https://esm.sh/viem";
        
        // ==================== Ú©Ø§Ù†ÙÛŒÚ¯ ====================
        const projectId = "96f13374b0fe2f629a925617de0a2ba3";
        
        const metadata = {
            name: "Token Balance Checker",
            description: "Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ØªÙˆÚ©Ù† Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„",
            url: window.location.href,
            icons: []
        };
        
        const chains = [mainnet, polygon, bsc, arbitrum, optimism, base];
        
        const wagmiConfig = defaultWagmiConfig({
            chains,
            projectId,
            metadata
        });
        
        // ==================== Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ ====================
        createWeb3Modal({
            wagmiConfig,
            projectId,
            chains
        });
        
        // Ø¯Ú©Ù…Ù‡ Ú©ÛŒÙ Ù¾ÙˆÙ„
        const btn = document.createElement("w3m-button");
        document.getElementById("wallet-btn").appendChild(btn);
        
        // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ ====================
        let currentAccount = null;
        
        // ==================== watching account ====================
        watchAccount(wagmiConfig, {
            onChange(account) {
                console.log('Account changed:', account);
                
                if (account?.address) {
                    // Ú©ÛŒÙ Ù¾ÙˆÙ„ ÙˆØµÙ„ Ø´Ø¯
                    currentAccount = account.address;
                    document.getElementById('walletAddress').style.display = 'block';
                    document.getElementById('walletAddress').innerHTML = `ğŸ”· ${account.address.substring(0, 6)}...${account.address.substring(38)}`;
                    document.getElementById('checkBtn').disabled = false;
                    
                    // Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ø®Ø·Ø§Ù‡Ø§
                    document.getElementById('error').style.display = 'none';
                } else {
                    // Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø·Ø¹ Ø´Ø¯
                    currentAccount = null;
                    document.getElementById('walletAddress').style.display = 'none';
                    document.getElementById('checkBtn').disabled = true;
                    document.getElementById('result').style.display = 'none';
                }
            }
        });
        
        // ==================== ABI Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„ Ø¨Ø±Ø§ÛŒ ERC20 ====================
        const ERC20_ABI = [
            {
                "constant": true,
                "inputs": [],
                "name": "name",
                "outputs": [{"name": "", "type": "string"}],
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "symbol",
                "outputs": [{"name": "", "type": "string"}],
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "decimals",
                "outputs": [{"name": "", "type": "uint8"}],
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [{"name": "_owner", "type": "address"}],
                "name": "balanceOf",
                "outputs": [{"name": "balance", "type": "uint256"}],
                "type": "function"
            }
        ];
        
        // ==================== Ù…Ù¾ Ú©Ø±Ø¯Ù† Ø´Ø¨Ú©Ù‡ Ø¨Ù‡ wagmi ====================
        const chainMap = {
            'eth': mainnet,
            'polygon': polygon,
            'bsc': bsc,
            'arbitrum': arbitrum,
            'optimism': optimism,
            'base': base
        };
        
        // ==================== Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ====================
        document.getElementById('checkBtn').addEventListener('click', checkBalance);
        
        async function checkBalance() {
            const tokenAddress = document.getElementById('tokenAddress').value.trim();
            const network = document.getElementById('networkSelect').value;
            
            if (!tokenAddress) {
                showError('Ù„Ø·ÙØ§Ù‹ Ø¢Ø¯Ø±Ø³ ØªÙˆÚ©Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            if (!tokenAddress.match(/^0x[a-fA-F0-9]{40}$/)) {
                showError('ÙØ±Ù…Øª Ø¢Ø¯Ø±Ø³ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª');
                return;
            }
            
            if (!currentAccount) {
                showError('Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ø±Ø§ Ù…ØªØµÙ„ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            // Ù†Ù…Ø§ÛŒØ´ Ù„ÙˆØ¯ÛŒÙ†Ú¯
            showLoading();
            
            try {
                const chain = chainMap[network];
                
                // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙˆÚ©Ù†
                const [symbol, decimals, balance] = await Promise.all([
                    readContract(wagmiConfig, {
                        address: tokenAddress,
                        abi: ERC20_ABI,
                        functionName: 'symbol',
                        chainId: chain.id
                    }),
                    readContract(wagmiConfig, {
                        address: tokenAddress,
                        abi: ERC20_ABI,
                        functionName: 'decimals',
                        chainId: chain.id
                    }),
                    readContract(wagmiConfig, {
                        address: tokenAddress,
                        abi: ERC20_ABI,
                        functionName: 'balanceOf',
                        args: [currentAccount],
                        chainId: chain.id
                    })
                ]);
                
                // ÙØ±Ù…Øª Ú©Ø±Ø¯Ù† Ù…ÙˆØ¬ÙˆØ¯ÛŒ
                const formattedBalance = formatUnits(balance, decimals);
                const balanceNumber = parseFloat(formattedBalance);
                
                // Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡
                showResult(symbol, balanceNumber, formattedBalance);
                
            } catch (error) {
                console.error('Error:', error);
                
                if (error.message.includes('execution reverted')) {
                    showError('ØªÙˆÚ©Ù† ÛŒØ§ÙØª Ù†Ø´Ø¯ ÛŒØ§ Ø¢Ø¯Ø±Ø³ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
                } else if (error.message.includes('network')) {
                    showError('Ø®Ø·Ø§ Ø¯Ø± Ø´Ø¨Ú©Ù‡. Ù„Ø·ÙØ§Ù‹ Ø´Ø¨Ú©Ù‡ ØµØ­ÛŒØ­ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                } else {
                    showError('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª: ' + error.message);
                }
            }
        }
        
        function showResult(symbol, balance, rawBalance) {
            const resultDiv = document.getElementById('result');
            
            if (balance > 0) {
                resultDiv.innerHTML = `
                    <div class="result">
                        <div class="balance-info">
                            <div class="token-symbol">Ù†Ù…Ø§Ø¯ ØªÙˆÚ©Ù†: ${symbol}</div>
                            <div class="balance-amount">${balance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 6})}</div>
                            <div style="color: #22c55e; margin-top: 10px;">âœ… Ø§ÛŒÙ† ØªÙˆÚ©Ù† Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª</div>
                            <div style="color: #94a3b8; font-size: 12px; margin-top: 15px;">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø®Ø§Ù…: ${rawBalance}</div>
                        </div>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="result">
                        <div class="balance-info">
                            <div class="token-symbol">Ù†Ù…Ø§Ø¯ ØªÙˆÚ©Ù†: ${symbol}</div>
                            <div class="not-found">
                                âš ï¸ Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 0 ${symbol}
                                <div style="font-size: 14px; margin-top: 10px;">Ø§ÛŒÙ† ØªÙˆÚ©Ù† Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ù†ÛŒØ³Øª</div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            resultDiv.style.display = 'block';
            document.getElementById('error').style.display = 'none';
        }
        
        function showLoading() {
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div class="result">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ...</p>
                    </div>
                </div>
            `;
            document.getElementById('error').style.display = 'none';
        }
        
        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.style.display = 'block';
            errorDiv.innerHTML = `âŒ ${message}`;
            document.getElementById('result').style.display = 'none';
        }
        
        // Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§ Ø§ÛŒÙ†ØªØ±
        document.getElementById('tokenAddress').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && currentAccount) {
                checkBalance();
            }
        });
    </script>
</body>
                    </html>
